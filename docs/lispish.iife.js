var lispish=function(e,r){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(_.get),a=function(e,r){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])})(e,r)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function u(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=e}a(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var o=function(){return(o=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var a in r=arguments[t])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)};function i(e,r){for(var t=0,n=r.length,a=e.length;t<n;t++,a++)e[a]=r[t];return e}var l=Symbol("function");function s(e){if(void 0===e)throw Error("Expected an AST node, got undefined");return e}function v(e){if(void 0===e||"Name"!==e.type)throw Error("Expected a Name node, got "+(e?e.type+" node":"undefined")+".");return e}function f(e){if(void 0===e||"Name"!==e.type)throw Error("Expected a Name node, got "+(e?e.type+" node":"undefined")+".")}function c(e){if(void 0===e)throw Error("Expected anything but undefined, got undefined");return e}function p(e){if(void 0===e)throw Error("Expected anything but undefined, got undefined")}function m(e){if("number"!=typeof e||!isFinite(e))throw TypeError("Expected number, got: "+e+' type="'+typeof e+'"')}function d(e){return m(e),e}function h(e){if(m(e),e<=0)throw TypeError("Expected positive number, got "+e)}function g(e){if(m(e),e<0)throw TypeError("Expected non negative number, got "+e)}function y(e){if(m(e),!Number.isInteger(e))throw TypeError("Expected integer, got "+e)}function E(e){if("string"!=typeof e)throw TypeError("Expected string, got: "+e+' type="'+typeof e+'"')}function b(e){if(!(e instanceof RegExp))throw TypeError("Expected RegExp, got: "+e+' type="'+typeof e+'"')}function x(e){if(!Array.isArray(e))throw TypeError("Expected list, got: "+e+' type="'+typeof e+'"')}function w(e){if(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof RegExp||F(e))throw TypeError("Expected object, got: "+e+' type="'+typeof e+'"')}function k(e){if(m(e),0===e)throw TypeError("Expected non zero value")}function N(e){if(0!==e.length)throw Error("Wrong number of arguments, expected 0, got "+e.length)}function A(e){if(1!==e.length)throw Error("Wrong number of arguments, expected 1, got "+e.length)}function S(e){if(2!==e.length)throw Error("Wrong number of arguments, expected 2, got "+e.length)}function O(e){if(3!==e.length)throw Error("Wrong number of arguments, expected 3, got "+e.length)}function M(e){if(e.length<1)throw Error("Wrong number of arguments, expected 1 or more, got "+e.length)}function j(e){if(e.length<2)throw Error("Wrong number of arguments, expected 2 or more, got "+e.length)}function T(e){if(1!==e.length&&2!==e.length)throw Error("Wrong number of arguments, expected 1 or 2, got "+e.length)}function P(e){if(1!==e.length&&2!==e.length&&3!==e.length)throw Error("Wrong number of arguments, expected 1, 2 or 3, got "+e.length)}function F(e){return null!==e&&"object"==typeof e&&!!e[l]}function L(e){if(null===e||"object"!=typeof e)throw Error("Not a lispish function");if(!e[l])throw Error("Not a lispish function")}var R={parse:function(e,r,t){var n=(0,t.parseParams)(e,r);return[n[0]+1,{type:"SpecialExpression",name:"if",params:n[1]}]},evaluate:function(e,r,t){var n=e.params,a=n[0],u=n[1],o=n[2],i=t(s(a),r)?s(u):s(o);return t(i,r)},validate:function(e){O(e.params)}},I={parse:function(e,r,t){var n=t.parseBinding,a=t.parseParams,u={type:"SpecialExpression",name:"let",params:[],bindings:[]},o=c(e[r]);if("paren"!==o.type||"("!==o.value)throw SyntaxError('Invalid token "'+o.type+'" value='+o.value+", expected list of bindings");for(r+=1;"paren"!==o.type||")"!==o.value;){if("paren"!==o.type||"("!==o.value)throw SyntaxError('Invalid token "'+o.type+'" value='+o.value+", expected an expression");var i=n(e,r),l=i[0],s=i[1];r=l,u.bindings.push(s),o=c(e[r])}var v=a(e,r+=1),f=v[0],p=v[1];return u.params=p,[f+1,u]},evaluate:function(e,r,t){for(var n={variables:{},functions:{}},a=0,u=e.bindings;a<u.length;a++){var o=u[a],l=t(o.value,r);if(F(l))throw Error("Cannot bind function in let expression");n.variables[o.name]=l}for(var s,v=i([n],r),f=0,c=e.params;f<c.length;f++){s=t(c[f],v)}return s}},C={parse:function(e,r,t){var n=(0,t.parseParams)(e,r),a=n[0],u=n[1];return f(u[0]),[a+1,{type:"SpecialExpression",name:"setq",params:u}]},evaluate:function(e,r,t){for(var n=v(e.params[0]).value,a=t(s(e.params[1]),r),u=void 0,o=0;o<r.length-1;o+=1)if(Object.getOwnPropertyDescriptor(c(r[o]).variables,n)){u=r[o];break}return u||(u=c(r[r.length-2])),u.variables[n]=a,a},validate:function(e){S(e.params)}};var W={parse:function(e,r,t){var n=function(e,r,t){for(var n=[],a=c(e[r]);"paren"!==a.type||")"!==a.value;){var u=t(e,r+1),o=u[0],i=u[1],l=[];for(a=c(e[r=o]);"paren"!==a.type||")"!==a.value;){var s=t(e,r),v=s[0],f=s[1];l.push(f),a=c(e[r=v])}n.push({test:i,body:l}),a=c(e[r+=1])}return[r,n]}(e,r,t.parseToken);return[n[0]+1,{type:"SpecialExpression",name:"cond",conditions:n[1],params:[]}]},evaluate:function(e,r,t){for(var n,a=0,u=e.conditions;a<u.length;a++){var o=u[a];if(n=t(o.test,r)){for(var i=0,l=o.body;i<l.length;i++){n=t(l[i],r)}return n}}}};function D(e,r,t){for(var n={mandatoryArguments:[],optionalArguments:[]},a={},u="mandatory",o=c(e[r]);"paren"!==o.type||")"!==o.value;){var i=t(e,r),l=i[0],s=i[1];if(o=c(e[r=l]),"Modifier"===s.type)switch(s.value){case"&optional":if("rest"===u)throw Error("&optional cannot appear after &rest");if("optional"===u)throw Error("&optional can only appear once");u="optional";break;case"&rest":if("rest"===u)throw Error("&rest can only appear once");if("optional"===u&&0===n.optionalArguments.length)throw Error("No optional arguments where spcified");u="rest"}else{if(a[s.name])throw Error('Duplicate argument "'+s.name+'"');if(a[s.name]=!0,Object.getOwnPropertyDescriptor(s,"defaultValue")){if("optional"!==u)throw Error("Cannot specify default value if not an optional argument");n.optionalArguments.push({name:s.name,defaultValue:s.defaultValue})}else switch(u){case"mandatory":n.mandatoryArguments.push(s.name);break;case"optional":n.optionalArguments.push({name:s.name,defaultValue:void 0});break;case"rest":if(n.restArgument)throw Error("Can only specify one rest argument");n.restArgument=s.name}}}if("rest"===u&&!Object.getOwnPropertyDescriptor(n,"restArgument"))throw Error("Missing rest argument name");if("optional"===u&&0===n.optionalArguments.length)throw Error("No optional arguments where spcified");return[r+=1,n]}var U={parse:function(e,r,t){var n=t.parseToken,a=t.parseArgument,u=n(e,r),o=u[0],i=u[1];if("Name"!==i.type)throw Error("Expected a name node");var l=c(e[r=o]);if("paren"!==l.type||"("!==l.value)throw SyntaxError('Invalid token "'+l.type+'" value='+l.value+", expected list of arguments");var s=D(e,r+=1,a),v=s[0],f=s[1];l=c(e[r=v]);for(var p=[];"paren"!==l.type||")"!==l.value;){var m=n(e,r),d=m[0],h=m[1];p.push(h),l=c(e[r=d])}if(0===p.length)throw Error("Missing defun body");return[r+1,{type:"SpecialExpression",name:"defun",functionName:i,params:[],arguments:f,body:p}]},evaluate:function(e,r,t){var n,a=((n={})[l]=!0,n.name=e.functionName.value,n.arguments=e.arguments,n.body=e.body,n);c(r[r.length-2]).functions[e.functionName.value]=a}},q={append:{evaluate:function(e){var r=e[0],t=e.slice(1);return x(r),t.reduce((function(e,r){return x(r),e.concat(r)}),r)},validate:function(e){return M(e.params)}},cons:{evaluate:function(e){var r=e[0],t=e[1];return x(t),i([r],t)},validate:function(e){return S(e.params)}},elt:{evaluate:function(e){var r=e[0],t=e[1];return x(r),g(t),r[t]},validate:function(e){return S(e.params)}},every:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;return L(n),x(a),0!==a.length&&a.every((function(e){return u(n,[e],r)}))},validate:function(e){return S(e.params)}},filter:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;return L(n),x(a),a.filter((function(e){return u(n,[e],r)}))},validate:function(e){return S(e.params)}},find:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;return L(n),x(a),a.find((function(e){return u(n,[e],r)}))},validate:function(e){return S(e.params)}},first:{evaluate:function(e){var r=e[0];return x(r),r[0]},validate:function(e){return A(e.params)}},last:{evaluate:function(e){var r=e[0];return x(r),r[r.length-1]},validate:function(e){return A(e.params)}},length:{evaluate:function(e){var r=e[0];return x(r),r.length},validate:function(e){return A(e.params)}},list:{evaluate:function(e){return e}},listf:{evaluate:function(e){var r=e[0],t=e[1];y(r),h(r);for(var n=[],a=0;a<r;a+=1)n.push(t);return n},validate:function(e){return S(e.params)}},map:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;return L(n),x(a),a.map((function(e){return u(n,[e],r)}))},validate:function(e){return S(e.params)}},pop:{evaluate:function(e){var r=e[0];return x(r),r.pop()},validate:function(e){return A(e.params)}},position:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;L(n),x(a);var o=a.findIndex((function(e){return u(n,[e],r)}));return-1!==o?o:void 0},validate:function(e){return S(e.params)}},push:{evaluate:function(e){var r=e[0],t=e.slice(1);return x(r),r.push.apply(r,t),r},validate:function(e){return j(e.params)}},range:{evaluate:function(e){var r,t,n,a=e[0],u=e[1],o=e[2];m(a),1===e.length?(r=0,n=(t=a)>=0?1:-1):2===e.length?(m(u),n=(t=u)>=(r=a)?1:-1):(m(u),m(o),n=o,(t=u)>(r=a)?h(n):t<r?function(e){if(m(e),e>=0)throw TypeError("Expected negative number, got "+e)}(n):k(n));for(var i=[],l=r;n<0?l>t:l<t;l+=n)i.push(l);return i},validate:function(e){return P(e.params)}},reduce:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=e[2],o=t.evaluateLispishFunction;return L(n),x(a),a.reduce((function(e,t){return o(n,[e,t],r)}),u)},validate:function(e){return O(e.params)}},"reduce-right":{evaluate:function(e,r,t){var n=e[0],a=e[1],u=e[2],o=t.evaluateLispishFunction;return L(n),x(a),a.reduceRight((function(e,t){return o(n,[e,t],r)}),u)},validate:function(e){return O(e.params)}},rest:{evaluate:function(e){var r=e[0];if(x(r),!(r.length<=1))return r.slice(1)},validate:function(e){return A(e.params)}},reverse:{evaluate:function(e){var r=e[0];return x(r),i([],r).reverse()},validate:function(e){return A(e.params)}},second:{evaluate:function(e){var r=e[0];return x(r),r[1]},validate:function(e){return A(e.params)}},selt:{evaluate:function(e){var r=e[0],t=e[1],n=e[2];return x(r),g(t),function(e,r){if(m(e),e>=r)throw TypeError("Expected parameter ("+e+") to be a number less than "+r)}(t,r.length),r[t]=n,r},validate:function(e){return O(e.params)}},shift:{evaluate:function(e){var r=e[0];return x(r),r.shift()},validate:function(e){return A(e.params)}},slice:{evaluate:function(e){var r=e[0],t=e[1],n=e[2];return x(r),1===e.length?i([],r):(y(t),2===e.length?r.slice(t):(y(n),r.slice(t,n)))},validate:function(e){return P(e.params)}},some:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;return L(n),x(a),0!==a.length&&a.some((function(e){return u(n,[e],r)}))},validate:function(e){return S(e.params)}},sort:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;L(n),x(a);var o=i([],a);return o.sort((function(e,t){var a=u(n,[e,t],r);return m(a),a})),o},validate:function(e){return S(e.params)}},splice:{evaluate:function(e){var r=e[0],t=e[1],n=e[2],a=e.slice(3);return x(r),y(t),2===e.length?r.splice(t):(y(n),r.splice.apply(r,i([t,n],a)))},validate:function(e){return j(e.params)}},take:{evaluate:function(e){var r=e[0],t=e[1];return x(r),g(t),y(t),r.slice(0,t)},validate:function(e){return S(e.params)}},"take-while":{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;x(a),L(n);for(var o=[],i=0,l=a;i<l.length;i++){var s=l[i];if(!u(n,[s],r))break;o.push(s)}return o},validate:function(e){return S(e.params)}},unshift:{evaluate:function(e){var r=e[0],t=e.slice(1);return x(r),r.unshift.apply(r,t),r},validate:function(e){return j(e.params)}}},z={"1+":{evaluate:function(e){var r=e[0];return m(r),d(r+1)},validate:function(e){return A(e.params)}},"1-":{evaluate:function(e){var r=e[0];return m(r),d(r-1)},validate:function(e){return A(e.params)}},"+":{evaluate:function(e){return d(e.reduce((function(e,r){return m(r),e+r}),0))}},"*":{evaluate:function(e){return d(e.reduce((function(e,r){return m(r),e*r}),1))}},"/":{evaluate:function(e){if(0===e.length)return 1;var r=e[0],t=e.slice(1);return m(r),0===t.length?(k(r),1/r):d(t.reduce((function(e,r){return k(r),e/r}),r))}},"-":{evaluate:function(e){var r=e[0],t=e.slice(1);return r?(m(r),0===t.length?-r:d(t.reduce((function(e,r){return m(r),e-r}),r))):0}},"%":{evaluate:function(e){var r=e[0],t=e[1];return m(r),k(t),d(r%t)},validate:function(e){return S(e.params)}},sqrt:{evaluate:function(e){var r=e[0];return g(r),d(Math.sqrt(r))},validate:function(e){return A(e.params)}},cbrt:{evaluate:function(e){var r=e[0];return g(r),d(Math.cbrt(r))},validate:function(e){return A(e.params)}},pow:{evaluate:function(e){var r=e[0],t=e[1];return m(r),m(t),d(Math.pow(r,t))},validate:function(e){return S(e.params)}},round:{evaluate:function(e){var r=e[0],t=e[1];if(m(r),1===e.length||0===t)return d(Math.round(r));h(t),y(t);var n=Math.pow(10,t);return d(Math.round(r*n)/n)},validate:function(e){return T(e.params)}},trunc:{evaluate:function(e){var r=e[0];return m(r),d(Math.trunc(r))},validate:function(e){return A(e.params)}},floor:{evaluate:function(e){var r=e[0];return m(r),d(Math.floor(r))},validate:function(e){return A(e.params)}},ceil:{evaluate:function(e){var r=e[0];return m(r),d(Math.ceil(r))},validate:function(e){return A(e.params)}},random:{evaluate:function(e){var r=e[0];return h(r),d(Math.random()*r)},validate:function(e){return A(e.params)}},">":{evaluate:function(e){var r=e[0],t=e.slice(1);if(m(r),0===t.length)return!0;for(var n=r,a=0,u=t;a<u.length;a++){var o=u[a];if(m(o),n<=o)return!1;n=o}return!0},validate:function(e){return M(e.params)}},"<":{evaluate:function(e){var r=e[0],t=e.slice(1);if(m(r),0===t.length)return!0;for(var n=r,a=0,u=t;a<u.length;a++){var o=u[a];if(m(o),n>=o)return!1;n=o}return!0},validate:function(e){return M(e.params)}},">=":{evaluate:function(e){var r=e[0],t=e.slice(1);if(m(r),0===t.length)return!0;for(var n=r,a=0,u=t;a<u.length;a++){var o=u[a];if(m(o),n<o)return!1;n=o}return!0},validate:function(e){return M(e.params)}},"<=":{evaluate:function(e){var r=e[0],t=e.slice(1);if(m(r),0===t.length)return!0;for(var n=r,a=0,u=t;a<u.length;a++){var o=u[a];if(m(o),n>o)return!1;n=o}return!0},validate:function(e){return M(e.params)}},min:{evaluate:function(e){var r=e[0],t=e.slice(1);return m(r),0===t.length?r:t.reduce((function(e,r){return m(r),Math.min(e,r)}),r)},validate:function(e){return M(e.params)}},max:{evaluate:function(e){var r=e[0],t=e.slice(1);return m(r),0===t.length?r:t.reduce((function(e,r){return m(r),Math.max(e,r)}),r)},validate:function(e){return M(e.params)}},abs:{evaluate:function(e){var r=e[0];return m(r),Math.abs(r)},validate:function(e){return A(e.params)}},sign:{evaluate:function(e){var r=e[0];return m(r),Math.sign(r)},validate:function(e){return A(e.params)}},e:{evaluate:function(){return Math.E},validate:function(e){return N(e.params)}},pi:{evaluate:function(){return Math.PI},validate:function(e){return N(e.params)}},exp:{evaluate:function(e){var r=e[0];return m(r),d(Math.exp(r))},validate:function(e){return A(e.params)}},log:{evaluate:function(e){var r=e[0];return h(r),d(Math.log(r))},validate:function(e){return A(e.params)}},log2:{evaluate:function(e){var r=e[0];return m(r),d(Math.log2(r))},validate:function(e){return A(e.params)}},log10:{evaluate:function(e){var r=e[0];return m(r),d(Math.log10(r))},validate:function(e){return A(e.params)}},sin:{evaluate:function(e){var r=e[0];return m(r),d(Math.sin(r))},validate:function(e){return A(e.params)}},asin:{evaluate:function(e){var r=e[0];return m(r),d(Math.asin(r))},validate:function(e){return A(e.params)}},sinh:{evaluate:function(e){var r=e[0];return m(r),d(Math.sinh(r))},validate:function(e){return A(e.params)}},asinh:{evaluate:function(e){var r=e[0];return m(r),d(Math.asinh(r))},validate:function(e){return A(e.params)}},cos:{evaluate:function(e){var r=e[0];return m(r),d(Math.cos(r))},validate:function(e){return A(e.params)}},acos:{evaluate:function(e){var r=e[0];return m(r),d(Math.acos(r))},validate:function(e){return A(e.params)}},cosh:{evaluate:function(e){var r=e[0];return m(r),d(Math.cosh(r))},validate:function(e){return A(e.params)}},acosh:{evaluate:function(e){var r=e[0];return m(r),d(Math.acosh(r))},validate:function(e){return A(e.params)}},tan:{evaluate:function(e){var r=e[0];return m(r),d(Math.tan(r))},validate:function(e){return A(e.params)}},atan:{evaluate:function(e){var r=e[0];return m(r),d(Math.atan(r))},validate:function(e){return A(e.params)}},tanh:{evaluate:function(e){var r=e[0];return m(r),d(Math.tanh(r))},validate:function(e){return A(e.params)}},atanh:{evaluate:function(e){var r=e[0];return m(r),d(Math.atanh(r))},validate:function(e){return A(e.params)}}},V={"!=":{evaluate:function(e){for(var r=0;r<e.length-1;r+=1)for(var t=r+1;t<e.length;t+=1)if(e[r]===e[t])return!1;return!0},validate:function(e){return M(e.params)}},"=":{evaluate:function(e){for(var r=e[0],t=0,n=e.slice(1);t<n.length;t++){if(n[t]!==r)return!1}return!0},validate:function(e){return M(e.params)}},apply:{evaluate:function(e,r,t){var n=e[0],a=e[1],u=t.evaluateLispishFunction;return L(n),x(a),u(n,a,r)},validate:function(e){return S(e.params)}},"get-path":{evaluate:function(e){var r=e[0],t=e[1];return function(e){if((null===e||"object"!=typeof e||Array.isArray(e)||e instanceof RegExp||F(e))&&!Array.isArray(e))throw TypeError("Expected object or array, got: "+e+' type="'+typeof e+'"')}(r),E(t),n.default(r,t)},validate:function(e){return S(e.params)}},not:{evaluate:function(e){return!e[0]},validate:function(e){return A(e.params)}},now:{evaluate:function(){return Date.now()},validate:function(e){return N(e.params)}},progn:{evaluate:function(e){return e[e.length-1]}},write:{evaluate:function(e){if(console.log.apply(console,e),e.length>0)return e[e.length-1]}},debug:{evaluate:function(e,r){var t=e[0];E(t),console.error("LISPISH: "+t+".","Context stack ("+r.map((function(e){return Object.keys(e.variables).length+":"+Object.keys(e.functions).length})).join(" ")+")",r)},validate:function(e){return A(e.params)}}},B={object:{evaluate:function(e){for(var r={},t=0;t<e.length;t+=2){var n=e[t],a=e[t+1];E(n),r[n]=a}return r},validate:function(e){return function(e){if(e.length%2!=0)throw Error("Wrong number of arguments, expected an even number, got "+e.length)}(e.params)}},keys:{evaluate:function(e){var r=e[0];return w(r),Object.keys(r)},validate:function(e){return A(e.params)}},values:{evaluate:function(e){var r=e[0];return w(r),Object.values(r)},validate:function(e){return A(e.params)}},entries:{evaluate:function(e){var r=e[0];return w(r),Object.entries(r)},validate:function(e){return A(e.params)}},"has-attr":{evaluate:function(e){var r=e[0],t=e[1];return w(r),E(t),!!Object.getOwnPropertyDescriptor(r,t)},validate:function(e){return S(e.params)}},"get-attr":{evaluate:function(e){var r=e[0],t=e[1];return w(r),E(t),r[t]},validate:function(e){return S(e.params)}},"set-attr":{evaluate:function(e){var r=e[0],t=e[1],n=e[2];return w(r),E(t),r[t]=n,n},validate:function(e){return O(e.params)}},"del-attr":{evaluate:function(e){var r=e[0],t=e[1];w(r),E(t);var n=r[t];return delete r[t],n},validate:function(e){return S(e.params)}},merge:{evaluate:function(e){var r=e[0],t=e.slice(1);return w(r),t.reduce((function(e,r){return w(r),o(o({},e),r)}),o({},r))},validate:function(e){return M(e.params)}}},G={"function?":{evaluate:function(e){return F(e[0])},validate:function(e){return A(e.params)}},"string?":{evaluate:function(e){return"string"==typeof e[0]},validate:function(e){return A(e.params)}},"number?":{evaluate:function(e){return"number"==typeof e[0]},validate:function(e){return A(e.params)}},"integer?":{evaluate:function(e){var r=e[0];return"number"==typeof r&&Number.isInteger(r)},validate:function(e){return A(e.params)}},"boolean?":{evaluate:function(e){return"boolean"==typeof e[0]},validate:function(e){return A(e.params)}},"undefined?":{evaluate:function(e){return void 0===e[0]},validate:function(e){return A(e.params)}},"null?":{evaluate:function(e){return null===e[0]},validate:function(e){return A(e.params)}},"zero?":{evaluate:function(e){var r=e[0];return m(r),0===r},validate:function(e){return A(e.params)}},"even?":{evaluate:function(e){var r=e[0];return m(r),r%2==0},validate:function(e){return A(e.params)}},"odd?":{evaluate:function(e){var r=e[0];return m(r),Number.isInteger(r)&&r%2!=0},validate:function(e){return A(e.params)}},"list?":{evaluate:function(e){var r=e[0];return Array.isArray(r)},validate:function(e){return A(e.params)}},"object?":{evaluate:function(e){var r=e[0];return!(null===r||Array.isArray(r)||"object"!=typeof r||r instanceof RegExp||F(r))},validate:function(e){return A(e.params)}},"regexp?":{evaluate:function(e){var r=e[0];return null!==r&&!Array.isArray(r)&&"object"==typeof r&&r instanceof RegExp},validate:function(e){return A(e.params)}},"empty?":{evaluate:function(e){var r=e[0];return x(r),0===r.length},validate:function(e){return A(e.params)}}},J={regexp:{evaluate:function(e){var r=e[0],t=e[1];return E(r),1===e.length?new RegExp(r):(E(t),new RegExp(r,t))},validate:function(e){return T(e.params)}},match:{evaluate:function(e){var r=e[0],t=e[1];b(r),E(t);var n=r.exec(t);if(n)return i([],n)},validate:function(e){return S(e.params)}},replace:{evaluate:function(e){var r=e[0],t=e[1],n=e[2];return E(r),b(t),E(n),r.replace(t,n)},validate:function(e){return O(e.params)}}},K={substring:{evaluate:function(e){var r=e[0],t=e[1],n=e[2];return E(r),m(t),g(t),void 0===n?r.substring(t):(function(e,r){if(m(e),e<r)throw TypeError("Expected parameter ("+e+") to be a number equal or grater than "+r)}(n,t),r.substring(t,n))},validate:function(e){return function(e){if(2!==e.length&&3!==e.length)throw Error("Wrong number of arguments, expected 2 or 3, got "+e.length)}(e.params)}},"string-length":{evaluate:function(e){var r=e[0];return E(r),r.length},validate:function(e){return A(e.params)}},"string-repeat":{evaluate:function(e){var r=e[0],t=e[1];return E(r),g(t),y(t),r.repeat(t)},validate:function(e){return S(e.params)}},concat:{evaluate:function(e){return e.reduce((function(e,r){return E(r),e+r}),"")}},aref:{evaluate:function(e){var r=e[0],t=e[1];return E(r),g(t),r[t]},validate:function(e){return S(e.params)}},"string>":{evaluate:function(e){var r=e[0],t=e[1];return E(r),E(t),r>t},validate:function(e){return S(e.params)}},"string<":{evaluate:function(e){var r=e[0],t=e[1];return E(r),E(t),r<t},validate:function(e){return S(e.params)}},"string>=":{evaluate:function(e){var r=e[0],t=e[1];return E(r),E(t),r>=t},validate:function(e){return S(e.params)}},"string<=":{evaluate:function(e){var r=e[0],t=e[1];return E(r),E(t),r<=t},validate:function(e){return S(e.params)}},"string-reverse":{evaluate:function(e){var r=e[0];return E(r),r.split("").reverse().join("")},validate:function(e){return A(e.params)}},"string-to-number":{evaluate:function(e){var r=e[0];E(r);var t=Number(r);if(Number.isNaN(t))throw Error("Could not convert '"+r+"' to a number");return t},validate:function(e){return A(e.params)}},"number-to-string":{evaluate:function(e){var r=e[0],t=e[1];if(m(r),1===e.length)return Number(r).toString();if(m(t),2!==t&&8!==t&&10!==t&&16!==t)throw Error("Expected base 2, 8, 10 or 16, got: "+t);return 10===t||(g(r),y(r)),Number(r).toString(t)},validate:function(e){return T(e.params)}},"lower-case":{evaluate:function(e){var r=e[0];return E(r),r.toLowerCase()},validate:function(e){return A(e.params)}},"upper-case":{evaluate:function(e){var r=e[0];return E(r),r.toUpperCase()},validate:function(e){return A(e.params)}},capitalize:{evaluate:function(e){var r=e[0];E(r);var t=r[0];return t?""+t.toUpperCase()+r.substring(1):""},validate:function(e){return A(e.params)}},trim:{evaluate:function(e){var r=e[0];return E(r),r.trim()},validate:function(e){return A(e.params)}}},H=o(o(o(o(o(o(o(o({},{lognot:{evaluate:function(e){var r=e[0];return y(r),~r},validate:function(e){return A(e.params)}},logand:{evaluate:function(e){var r=e[0],t=e.slice(1);return 0===e.length?-1:(y(r),t.reduce((function(e,r){return y(r),e&r}),r))}},logor:{evaluate:function(e){var r=e[0],t=e.slice(1);return 0===e.length?0:(y(r),t.reduce((function(e,r){return y(r),e|r}),r))}},logxor:{evaluate:function(e){var r=e[0],t=e[1];return y(r),y(t),r^t},validate:function(e){return S(e.params)}}}),q),z),V),B),G),J),K),X={parse:function(e,r,t){var n=(0,t.parseToken)(e,r),a=n[0],u=n[1];if("Name"!==u.type)throw Error("Expected a name node");var o=c(e[r=a]);if("paren"!==o.type||")"!==o.value)throw SyntaxError('Invalid token "'+o.type+'" value='+o.value+", expected ')'");return[r+1,{type:"SpecialExpression",name:"function",params:[u]}]},evaluate:function(e,r){for(var t,n=v(e.params[0]),a=void 0,u=0,o=r;u<o.length;u++){if(a=o[u].functions[n.value])break}if(a)return a;if(!H[n.value])throw Error("Could not find built in function (normal expresssion) "+n.value);return(t={})[l]=!0,t.builtin=n.value,t},validate:function(e){A(e.params)}},Z={parse:function(e,r,t){var n=t.parseToken,a=t.parseArgument,u=c(e[r]);if("paren"!==u.type||"("!==u.value)throw SyntaxError('Invalid token "'+u.type+'" value='+u.value+", expected list of arguments");var o=D(e,r+=1,a),i=o[0],l=o[1];u=c(e[r=i]);for(var s=[];"paren"!==u.type||")"!==u.value;){var v=n(e,r),f=v[0],p=v[1];s.push(p),u=c(e[r=f])}if(0===s.length)throw Error("Missing lambda body");return[r+1,{type:"SpecialExpression",name:"lambda",params:[],arguments:l,body:s}]},evaluate:function(e){var r;return(r={})[l]=!0,r.name=void 0,r.arguments=e.arguments,r.body=e.body,r}},$=function(e){function r(t,n){var a=e.call(this,'return-from block "'+t+'" with value: '+n)||this;return Object.setPrototypeOf(a,r.prototype),a.name="ReturnFromSignal",a.blockName=t,a.value=n,a}return u(r,e),r}(Error),Q=function(e){function r(t){var n=e.call(this,"return with value: "+t)||this;return Object.setPrototypeOf(n,r.prototype),n.name="ReturnSignal",n.value=t,n}return u(r,e),r}(Error),Y=function(e){function r(t){var n=e.call(this,t)||this;return Object.setPrototypeOf(n,r.prototype),n.name="UserDefinedError",n}return u(r,e),r}(Error),ee={let:I,if:R,setq:C,and:{parse:function(e,r,t){var n=(0,t.parseParams)(e,r);return[n[0]+1,{type:"SpecialExpression",name:"and",params:n[1]}]},evaluate:function(e,r,t){for(var n=!0,a=0,u=e.params;a<u.length;a++){if(!(n=t(u[a],r)))break}return n}},or:{parse:function(e,r,t){var n=(0,t.parseParams)(e,r);return[n[0]+1,{type:"SpecialExpression",name:"or",params:n[1]}]},evaluate:function(e,r,t){for(var n=!1,a=0,u=e.params;a<u.length;a++){if(n=t(u[a],r))break}return n}},cond:W,defun:U,function:X,lambda:Z,"return-from":{parse:function(e,r,t){var n=t.parseToken,a=c(e[r]);if("name"!==a.type)throw Error("Expected a name node, got "+a.type+": "+a.value);var u={type:"SpecialExpression",name:"return-from",blockName:a.value,params:[]},o=n(e,r+=1),i=o[0],l=o[1];return u.params.push(l),[i+1,u]},evaluate:function(e,r,t){var n=t(c(e.params[0]),r);throw new $(e.blockName,n)},validate:function(e){return A(e.params)}},return:{parse:function(e,r,t){var n={type:"SpecialExpression",name:"return",params:[]},a=(0,t.parseToken)(e,r),u=a[0],o=a[1];return n.params.push(o),[u+1,n]},evaluate:function(e,r,t){var n=t(c(e.params[0]),r);throw new Q(n)},validate:function(e){return A(e.params)}},block:{parse:function(e,r,t){var n=t.parseToken,a=c(e[r]);if("name"!==a.type)throw Error("Expected a name node, got "+a.type+": "+a.value);r+=1;var u={type:"SpecialExpression",name:"block",blockName:a.value,params:[]};for(a=c(e[r]);"paren"!==a.type||")"!==a.value;){var o=n(e,r),i=o[0],l=o[1];u.params.push(l),a=c(e[r=i])}return[r+1,u]},evaluate:function(e,r,t){var n;try{for(var a=0,u=e.params;a<u.length;a++){n=t(u[a],r)}return n}catch(r){if(r instanceof $&&e.blockName===r.blockName)return r.value;throw r}},validate:function(e){return M(e.params)}},try:{parse:function(e,r,t){var n=t.parseToken,a=n(e,r),u=a[0],o=a[1],i=c(e[r=u]);if("paren"!==i.type||"("!==i.value)throw Error('Expected "("');if("paren"!==(i=c(e[r+=1])).type||"("!==i.value)throw Error('Expected "("');var l=n(e,r+=1),s=l[0],v=l[1];if("Name"!==v.type)throw Error("Expected name node, got: "+v.type);if("paren"!==(i=c(e[r=s])).type||")"!==i.value)throw Error('Expected ")"');var f=n(e,r+=1),p=f[0],m=f[1];if("paren"!==(i=c(e[r=p])).type||")"!==i.value)throw Error('Expected ")"');if("paren"!==(i=c(e[r+=1])).type||")"!==i.value)throw Error('Expected ")"');return[r+=1,{type:"SpecialExpression",name:"try",params:[],tryExpression:o,catchExpression:m,error:v}]},evaluate:function(e,r,t){var n;try{return t(e.tryExpression,r)}catch(u){if(u instanceof $||u instanceof Q)throw u;var a={functions:{},variables:(n={},n[e.error.value]=u,n)};return t(e.catchExpression,i([a],r))}}},throw:{parse:function(e,r,t){var n=(0,t.parseToken)(e,r),a=n[0],u=n[1],o=c(e[r=a]);if("paren"!==o.type||")"!==o.value)throw Error('Expected ")"');return[r+=1,{type:"SpecialExpression",name:"throw",params:[],messageNode:u}]},evaluate:function(e,r,t){var n=function(e){if("string"!=typeof e||0===e.length)throw TypeError("Expected non empty string, got: "+e+' type="'+typeof e+'"');return e}(t(e.messageNode,r));throw new Y(n)}},when:{parse:function(e,r,t){var n=(0,t.parseParams)(e,r);return[n[0]+1,{type:"SpecialExpression",name:"when",params:n[1]}]},evaluate:function(e,r,t){var n=e.params,a=n[0],u=n.slice(1);if(p(a),t(a,r)){for(var o=void 0,i=0,l=u;i<l.length;i++){o=t(l[i],r)}return o}},validate:function(e){return M(e.params)}},unless:{parse:function(e,r,t){var n=(0,t.parseParams)(e,r);return[n[0]+1,{type:"SpecialExpression",name:"unless",params:n[1]}]},evaluate:function(e,r,t){var n=e.params,a=n[0],u=n.slice(1);if(p(a),!t(a,r)){for(var o=void 0,i=0,l=u;i<l.length;i++){o=t(l[i],r)}return o}},validate:function(e){return M(e.params)}},loop:{parse:function(e,r,t){for(var n=t.parseToken,a={type:"SpecialExpression",name:"loop",params:[]},u=c(e[r]);"paren"!==u.type||")"!==u.value;){var o=n(e,r),i=o[0],l=o[1];a.params.push(l),u=c(e[r=i])}return[r+1,a]},evaluate:function(e,r,t){try{for(;;)for(var n=0,a=e.params;n<a.length;n++){t(a[n],r)}}catch(e){if(e instanceof Q)return e.value;throw e}},validate:function(e){return M(e.params)}},dolist:{parse:function(e,r,t){var n,a,u,o,i,l,s=t.parseToken,v=c(e[r]);if("paren"!==v.type||"("!==v.value)throw Error('Expected "(", got '+v.type+": "+v.value);r=(n=s(e,r+=1))[0],f(i=n[1]),r=(a=s(e,r))[0],l=a[1];var p=void 0;"paren"===(v=c(e[r])).type&&")"===v.value||(r=(u=s(e,r))[0],p=u[1]);var m={type:"SpecialExpression",name:"dolist",params:[],varName:i,result:p,list:l};for(v=c(e[r+=1]);"paren"!==v.type||")"!==v.value;){var d;r=(o=s(e,r))[0],d=o[1],m.params.push(d),v=c(e[r])}return[r+1,m]},evaluate:function(e,r,t){var n,a=t(e.list,r);x(a);var u=e.varName.value,o={functions:{},variables:(n={},n[u]=void 0,n)},l=i([o],r);try{for(;a.length>0;){var s=a.shift();o.variables[u]=s;for(var v=0,f=e.params;v<f.length;v++){t(f[v],l)}}}catch(e){if(e instanceof Q)return e.value;throw e}if(e.result)return o.variables[u]=void 0,t(e.result,l)}},dotimes:{parse:function(e,r,t){var n,a,u,o,i,l,s=t.parseToken,v=c(e[r]);if("paren"!==v.type||"("!==v.value)throw Error('Expected "(", got '+v.type+": "+v.value);r=(n=s(e,r+=1))[0],f(i=n[1]),r=(a=s(e,r))[0],l=a[1];var p=void 0;"paren"===(v=c(e[r])).type&&")"===v.value||(r=(u=s(e,r))[0],p=u[1]);var m={type:"SpecialExpression",name:"dotimes",params:[],varName:i,result:p,count:l};for(v=c(e[r+=1]);"paren"!==v.type||")"!==v.value;){var d;r=(o=s(e,r))[0],d=o[1],m.params.push(d),v=c(e[r])}return[r+1,m]},evaluate:function(e,r,t){var n,a=t(e.count,r);y(a),g(a);var u=e.varName.value,o={functions:{},variables:(n={},n[u]=void 0,n)},l=i([o],r);try{var s=void 0;for(s=0;s<a;s+=1){o.variables[u]=s;for(var v=0,f=e.params;v<f.length;v++){t(f[v],l)}}if(!e.result)return;return o.variables[u]=s,t(e.result,l)}catch(e){if(e instanceof Q)return e.value;throw e}}},while:{parse:function(e,r,t){var n,a=t.parseToken;r=(n=a(e,r))[0];for(var u={type:"SpecialExpression",name:"while",params:[],whileExpression:n[1]},o=c(e[r]);"paren"!==o.type||")"!==o.value;){var i=a(e,r),l=i[0],s=i[1];u.params.push(s),o=c(e[r=l])}return[r+1,u]},evaluate:function(e,r,t){for(;t(e.whileExpression,r);)for(var n=0,a=e.params;n<a.length;n++){t(a[n],r)}}}};Object.keys(ee).forEach((function(e){if(H[e])throw Error("Expression "+e+" is defined as both a normal expression and a special expression")}));var re={normalExpressions:H,specialExpressions:ee},te=Object.keys(H),ne=Object.keys(ee),ae={true:{value:!0},false:{value:!1},null:{value:null},undefined:{value:void 0}},ue=Object.keys(ae);function oe(e,r,t){for(var n,a=[t,{variables:r,functions:{}}],u=0,o=e.body;u<o.length;u++){var i=o[u];n=ie(i,a)}return n}var ie=function(e,r){switch(e.type){case"Number":case"String":return function(e){return e.value}(e);case"Name":return function(e,r){for(var t=e.value,n=0,a=r;n<a.length;n++){var u=a[n];if(Object.getOwnPropertyDescriptor(u.variables,t))return u.variables[t]}throw Error("Undefined identifier "+t)}(e,r);case"ReservedName":return function(e){return c(ae[e.value]).value}(e);case"NormalExpression":return function(e,r){for(var t=e.params.map((function(e){return ie(e,r)})),n=void 0,a=0,u=r;a<u.length;a++){if(n=u[a].functions[e.name])break}return n?le(n,t,r):function(e,r,t){return(0,c(re.normalExpressions[e.name]).evaluate)(r,t,{evaluateLispishFunction:le})}(e,t,r)}(e,r);case"SpecialExpression":return function(e,r){return(0,c(re.specialExpressions[e.name]).evaluate)(e,r,ie)}(e,r);case"ExpressionExpression":return function(e,r){var t=function(e){if(F(e))return e;throw Error("Expected a Lispish function, got "+e)}(ie(e.expression,r)),n=e.params.map((function(e){return ie(e,r)}));return le(t,n,r)}(e,r)}};var le=function(e,r,t){var n={functions:{},variables:{}};if(!F(a=e)||!a.arguments)return c(H[e.builtin]).evaluate(r,t,{evaluateLispishFunction:le});var a,u=e.arguments,o=u.mandatoryArguments.length,l=u.optionalArguments.length,s=u.restArgument?null:o+l;if(r.length<u.mandatoryArguments.length)throw Error('Function "'+e.name+'" requires at least '+u.mandatoryArguments.length+" arguments. Got "+r.length);if(null!==s&&r.length>s)throw Error('Function "'+e.name+'" requires at most '+s+" arguments. Got "+r.length);for(var v=Math.max(r.length,u.mandatoryArguments.length+u.optionalArguments.length),f=[],p=0;p<v;p+=1)if(p<o){var m=r[p],d=c(u.mandatoryArguments[p]);F(m)?n.functions[d]=m:n.variables[d]=m}else if(p<o+l){var h=c(u.optionalArguments[p-o]);m=p<r.length?r[p]:void 0!==h.defaultValue?ie(h.defaultValue,t):void 0,d=h.name;F(m)?n.functions[d]=m:n.variables[d]=m}else{if(F(m=r[p]))throw Error("A function cannot be a &rest parameter TODO, is this a fact?");f.push(m)}u.restArgument&&(n.variables[u.restArgument]=f);try{for(var g=void 0,y=0,E=e.body;y<E.length;y++){var b=E[y];g=ie(b,i([n],t))}return g}catch(r){if(r instanceof Q)return r.value;if(r instanceof $&&e.name===r.blockName)return r.value;throw r}};var se=function(e,r){for(var t=c(e[r]),n=[];"paren"!==t.type||")"!==t.value;){var a=he(e,r),u=a[0],o=a[1];r=u,n.push(o),t=c(e[r])}return[r,n]},ve=function(e,r){var t=c(e[r+=1]);if("name"===t.type){var n=t.value;return re.specialExpressions[n]?de(e,r):me(e,r)}if("paren"===t.type&&"("===t.value)return pe(e,r);throw Error("Could not parse expression")},fe=function(e,r){var t=c(e[r]);if("name"===t.type)return[r+1,{type:"Argument",name:t.value}];if("paren"===t.type&&"("===t.value){if("name"!==(t=c(e[r+=1])).type)throw Error("Expected name node got: "+t.type+": "+t.value);var n=t.value,a=he(e,r+=1),u=a[0],o=a[1];if("paren"!==(t=c(e[u])).type||")"!==t.value)throw Error('Expected ")"');return[u+1,{type:"Argument",name:n,defaultValue:o}]}if("modifier"===t.type)return[r+1,{type:"Modifier",value:t.value}];throw Error("Unexpected token: "+t.type+": "+t.value)},ce=function(e,r){var t=c(e[r+=1]);if("name"!==t.type)throw Error("Expected name node in binding, got "+t.type+" value="+t.value);var n=t.value;t=c(e[r+=1]);var a=he(e,r),u=a[0],o=a[1];if("paren"!==(t=c(e[r=u])).type||")"!==t.value)throw Error("Expected paren ')'node in binding, got "+t.type+" value="+t.value);return[r+1,{type:"Binding",name:n,value:o}]},pe=function(e,r){var t=ve(e,r),n=t[0],a=t[1],u=se(e,n);return[u[0]+1,{type:"ExpressionExpression",expression:a,params:u[1]}]},me=function(e,r){var t,n=c(e[r]).value,a=se(e,r+1);r=a[0]+1;var u={type:"NormalExpression",name:n,params:a[1]},o=re.normalExpressions[u.name];if(o)try{null===(t=o.validate)||void 0===t||t.call(o,u)}catch(e){throw Error(e.message+"\n"+JSON.stringify(u,null,2))}return[r,u]},de=function(e,r){var t=c(e[r]).value;r+=1;var n=c(re.specialExpressions[t]),a=n.parse,u=n.validate,o=a(e,r,{parseExpression:ve,parseParams:se,parseToken:he,parseBinding:ce,parseArgument:fe}),i=o[0],l=o[1];try{null==u||u(l)}catch(e){throw Error(e.message+"\n"+JSON.stringify(l,null,2))}return[i,l]},he=function(e,r){var t=c(e[r]),n=void 0;switch(t.type){case"number":n=function(e,r){var t=c(e[r]);return[r+1,{type:"Number",value:Number(t.value)}]}(e,r);break;case"string":n=function(e,r){return[r+1,{type:"String",value:c(e[r]).value}]}(e,r);break;case"name":n=function(e,r){return[r+1,{type:"Name",value:c(e[r]).value}]}(e,r);break;case"reservedName":n=function(e,r){return[r+1,{type:"ReservedName",value:c(e[r]).value}]}(e,r);break;case"paren":"("===t.value&&(n=ve(e,r));break;case"shorthand":n=function(e,r){var t=he(e,r+1);return[t[0],{type:"SpecialExpression",name:"function",params:[t[1]]}]}(e,r)}if(!n)throw SyntaxError("Unrecognized token: "+t.type+" value="+t.value);return n};function ge(e){for(var r,t,n={type:"Program",body:[]},a=0;a<e.length;)a=(r=he(e,a))[0],t=r[1],n.body.push(t);return n}var ye=/[0-9a-zA-Z_^?=!$%<>.+*/\-[\]]/,Ee=/\s|\)/,be=/[0-9]/,xe=/[0-7]/,we=/[0-9a-fA-F]/,ke=/[0-1]/,Ne=/[0-9.-]/;function Ae(e,r,t,n){return r===t[n]?[1,{type:e,value:r}]:[0,void 0]}var Se=[function(e,r){if(";"===e[r]){for(var t=1;"\n"!==e[r+t]&&r+t<e.length;)t+=1;return"\n"===e[r+t]&&r+t<e.length&&(t+=1),[t,void 0]}return[0,void 0]},function(e,r){var t;return/\s/.test(null!==(t=e[r])&&void 0!==t?t:"")?[1,void 0]:[0,void 0]},function(e,r){return Ae("paren","(",e,r)},function(e,r){return Ae("paren",")",e,r)},function(e,r){if('"'!==e[r])return[0,void 0];for(var t="",n=1,a=e[r+n],u=!1;'"'!==a||u;){if(void 0===a)throw new SyntaxError("Unclosed string at position "+r);u?(u=!1,'"'===a||"\\"===a||(t+="\\"),t+=a):"\\"===a?u=!0:t+=a,a=e[r+(n+=1)]}return[n+1,{type:"string",value:t}]},function(e,r){var t="decimal",n=e[r];if(void 0===n)return[0,void 0];var a,u="."===n;if(!Ne.test(n))return[0,void 0];for(a=r+1;a<e.length;a+=1){var o=c(e[a]);if(Ee.test(o))break;if(a===r+1&&"0"===n){if("b"===o||"B"===o){t="binary";continue}if("o"===o||"O"===o){t="octal";continue}if("x"===o||"X"===o){t="hex";continue}}if("decimal"===t&&u){if(!be.test(o))return[0,void 0]}else if("binary"===t){if(!ke.test(o))return[0,void 0]}else if("octal"===t){if(!xe.test(o))return[0,void 0]}else if("hex"===t){if(!we.test(o))return[0,void 0]}else{if("."===o){u=!0;continue}if(!be.test(o))return[0,void 0]}}var i=a-r,l=e.substring(r,a);return"decimal"!==t&&i<=2||"."===l||"-"===l?[0,void 0]:[i,{type:"number",value:l}]},function(e,r){for(var t=0,n=Object.keys(ae);t<n.length;t++){var a=n[t],u=a.length,o=e[r+u];if((!o||!ye.test(o))&&e.substr(r,u)===a)return[u,{type:"reservedName",value:a}]}return[0,void 0]},function(e,r){return function(e,r,t,n){var a=t[n],u=0,o="";if(!a||!r.test(a))return[0,void 0];for(;a&&r.test(a);)o+=a,a=t[n+(u+=1)];return[u,{type:e,value:o}]}("name",ye,e,r)},function(e,r){return"#'"===e.substr(r,2)?[2,{type:"shorthand",value:"#'"}]:[0,void 0]},function(e,r){return"&rest"===e.substr(r,5)?[5,{type:"modifier",value:"&rest"}]:"&optional"===e.substr(r,9)?[9,{type:"modifier",value:"&optional"}]:[0,void 0]}];function Oe(e){for(var r=[],t=0,n=!1;t<e.length;){n=!1;for(var a=0,u=Se;a<u.length;a++){var o=(0,u[a])(e,t),i=o[0],l=o[1];if(i>0&&(n=!0,t+=i,l)){r.push(l);break}}if(!n)throw new SyntaxError("Unrecognized character at position "+t+": '"+e[t]+"'")}return r}return e.evaluate=oe,e.isLispishFunction=F,e.lispish=function(e,r,t){return void 0===r&&(r={}),void 0===t&&(t={variables:{},functions:{}}),oe(ge(Oe(e)),r,t)},e.normalExpressionKeys=te,e.parse=ge,e.reservedNames=ue,e.specialExpressionKeys=ne,e.tokenize=Oe,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=lispish.iife.js.map
